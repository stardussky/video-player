var K=Object.defineProperty,q=Object.defineProperties;var W=Object.getOwnPropertyDescriptors;var D=Object.getOwnPropertySymbols;var X=Object.prototype.hasOwnProperty,Q=Object.prototype.propertyIsEnumerable;var R=(o,e,t)=>e in o?K(o,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):o[e]=t,E=(o,e)=>{for(var t in e||(e={}))X.call(e,t)&&R(o,t,e[t]);if(D)for(var t of D(e))Q.call(e,t)&&R(o,t,e[t]);return o},C=(o,e)=>q(o,W(e));import{j as M,P as l,r,c as w,u as G,a as J,R as Y,b as ee,B as te,S as se,d as V}from"./vendor.d57fdb0f.js";const ie=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))a(i);new MutationObserver(i=>{for(const n of i)if(n.type==="childList")for(const h of n.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&a(h)}).observe(document,{childList:!0,subtree:!0});function t(i){const n={};return i.integrity&&(n.integrity=i.integrity),i.referrerpolicy&&(n.referrerPolicy=i.referrerpolicy),i.crossorigin==="use-credentials"?n.credentials="include":i.crossorigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function a(i){if(i.ep)return;i.ep=!0;const n=t(i);fetch(i.href,n)}};ie();if(typeof window!="undefined"){let o=function(){let e=document.body,t=document.getElementById("__svg__icons__dom__1636464692545__");t||(t=document.createElementNS("http://www.w3.org/2000/svg","svg"),t.style.position="absolute",t.style.width="0",t.style.height="0",t.id="__svg__icons__dom__1636464692545__"),t.innerHTML='<symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 14 14" id="fullscreen"><g fill="none" fill-rule="evenodd"><path d="M-5-5h24v24H-5z" /><path fill="#fff" d="M2 9H0v5h5v-2H2V9ZM0 5h2V2h3V0H0v5Zm12 7H9v2h5V9h-2v3ZM9 0v2h3v3h2V0H9Z" /></g></symbol><symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" id="mute"><path d="M15.106 5 13 7.094 10.894 5 10 5.894 12.094 8 10 10.106l.894.894L13 8.906 15.106 11l.894-.894L13.906 8 16 5.894 15.106 5ZM8 15V1L2.4 5.375H0v5.25h2.4L8 15Z" /></symbol><symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 6 8" id="pause"><path fill="#fff" fill-rule="evenodd" d="M1 0a1 1 0 0 0-1 1v6a1 1 0 0 0 2 0V1a1 1 0 0 0-1-1m5 1v6a1 1 0 0 1-2 0V1a1 1 0 0 1 2 0" /></symbol><symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 22 18" id="picture"><path d="M18 8h-8v6h8V8Zm4 8V1.98C22 .88 21.1 0 20 0H2C.9 0 0 .88 0 1.98V16c0 1.1.9 2 2 2h18a2 2 0 0 0 2-2Zm-2 .02H2V1.97h18v14.05Z" /></symbol><symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 11 14" id="play"><path d="M0 1.82v10.36a1 1 0 0 0 1.54.84l8.14-5.18a1 1 0 0 0 0-1.69L1.54.98A1 1 0 0 0 0 1.82Z" fill-rule="evenodd" /></symbol><symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 20" id="replay"><g fill="none" fill-rule="evenodd"><path d="M-4-1h24v24H-4z" /><path fill="#fff" d="M8 4V0L3 5l5 5V6a6 6 0 1 1-6 6H0a8 8 0 1 0 8-8Z" /></g></symbol><symbol fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 48 48" id="setting"><path d="M41.558 26.34c.095-.768.166-1.548.166-2.34 0-.792-.071-1.572-.166-2.34l5-3.972a1.216 1.216 0 0 0 .284-1.536l-4.728-8.316a1.161 1.161 0 0 0-1.442-.516l-5.886 2.412a17.88 17.88 0 0 0-3.996-2.364l-.886-6.36C29.798.444 29.313 0 28.722 0h-9.456c-.59 0-1.075.444-1.17 1.008l-.886 6.36a17.433 17.433 0 0 0-3.996 2.364L7.328 7.32a1.165 1.165 0 0 0-.814-.01 1.186 1.186 0 0 0-.628.526l-4.728 8.316a1.216 1.216 0 0 0 .284 1.536L6.43 21.66A19.122 19.122 0 0 0 6.265 24c0 .792.07 1.572.165 2.34l-4.988 3.972a1.216 1.216 0 0 0-.284 1.536l4.728 8.316c.296.516.91.732 1.442.516l5.886-2.412a17.878 17.878 0 0 0 3.996 2.364l.886 6.36c.095.564.58 1.008 1.17 1.008h9.456c.591 0 1.076-.444 1.17-1.008l.887-6.36a17.43 17.43 0 0 0 3.995-2.364l5.886 2.412c.262.101.55.105.814.01.264-.094.487-.28.628-.526l4.728-8.316a1.215 1.215 0 0 0-.284-1.536l-4.988-3.972ZM23.994 32.4a8.16 8.16 0 0 1-3.261-.543 8.259 8.259 0 0 1-2.792-1.796 8.405 8.405 0 0 1-1.877-2.762 8.51 8.51 0 0 1-.005-6.575 8.406 8.406 0 0 1 1.873-2.765 8.26 8.26 0 0 1 2.79-1.8 8.161 8.161 0 0 1 3.26-.547c2.139.08 4.164 1 5.65 2.563A8.468 8.468 0 0 1 31.948 24a8.469 8.469 0 0 1-2.31 5.828 8.218 8.218 0 0 1-5.645 2.572Z" fill="#fff" /></symbol><symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 12" id="skip"><path fill="#fff" d="m1.58 10.89 5.77-4.07a1 1 0 0 0 0-1.63L1.58 1.11A1 1 0 0 0 0 1.93v8.14a1 1 0 0 0 1.58.82ZM10 1v10a1 1 0 0 0 1 1 1 1 0 0 0 1-1V1a1 1 0 0 0-1-1 1 1 0 0 0-1 1Z" fill-rule="evenodd" /></symbol><symbol fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" id="volume"><path d="M0 10.737h3.56l4.45 4.56V.703L3.56 5.263H0v5.474ZM9.79 4.35v7.298a3.94 3.94 0 0 0 1.63-1.492A4.08 4.08 0 0 0 12.016 8a4.171 4.171 0 0 0-.608-2.148 4.033 4.033 0 0 0-1.617-1.5Zm0-2.472a6.232 6.232 0 0 1 3.218 2.303A6.492 6.492 0 0 1 14.245 8a6.491 6.491 0 0 1-1.237 3.818 6.232 6.232 0 0 1-3.218 2.303V16a7.988 7.988 0 0 0 4.468-2.888A8.34 8.34 0 0 0 16 8a8.34 8.34 0 0 0-1.742-5.112A7.988 7.988 0 0 0 9.79 0v1.88Z" fill="#fff" /></symbol>',e.insertBefore(t,e.firstChild)};document.readyState==="loading"?document.addEventListener("DOMContentLoaded",o):o()}const s=M.exports.jsx,u=M.exports.jsxs;function g(o){const{name:e}=o,t=`#${e}`;return s("svg",C(E({},o),{className:"icon svg-icon","aria-hidden":"true",children:s("use",{href:t})}))}g.propTypes={name:l.string};function I({videoEl:o,currentTime:e}){const[t,a]=r.exports.useState({}),[i,n]=r.exports.useState({}),h=r.exports.useRef(null),d=r.exports.useRef(null),m=r.exports.useRef(null),v=r.exports.useRef(null),p=()=>{let c=document.querySelector(o);if(c&&c instanceof HTMLVideoElement){c=c.cloneNode(!0),c.crossOrigin="anonymous",d.current=c;const{clientWidth:f,clientHeight:j}=h.current;m.current=document.createElement("canvas"),m.current.width=f,m.current.height=j,v.current=m.current.getContext("2d"),d.current.addEventListener("timeupdate",b);const _=c.cloneNode(!0);_.addEventListener("loadedmetadata",async()=>{const{duration:U}=_;for(let x=0;x<=Math.ceil(U);x++)_.currentTime=x,await new Promise($=>{_.addEventListener("canplay",()=>{const k=S(_,0);n(z=>C(E({},z),{[x]:k})),$(k)},{once:!0})})},{once:!0})}},y=c=>{!d.current||t[c]||(d.current.currentTime=c)},b=()=>{const c=S(d.current,1);c&&a(f=>C(E({},f),{[d.current.currentTime]:c}))},S=(c,f=1)=>{if(c instanceof HTMLVideoElement&&m.current&&v.current)return v.current.drawImage(c,0,0,m.current.width,m.current.height),m.current.toDataURL("image/webp",f)};r.exports.useEffect(()=>(p(),()=>{d.current.removeEventListener("timeupdate",b)}),[]),r.exports.useEffect(()=>{y(e)},[e]);const T=r.exports.useMemo(()=>{const c=Math.ceil(e);return t[c]||i[c]},[e,t]);return s("div",{className:"video-thumbnail",ref:h,children:s("div",{style:{background:T?`url(${T}) no-repeat center / cover`:"#111"}})})}I.propTypes={videoEl:l.string,currentTime:l.number};var N=o=>{let e=o|0;const t=e%60;e=(e-t)/60;const a=e%60,i=e/60|0;return`${i?i+":":""}${(i?String(a).padStart(2,"0"):a)+":"}${String(t).padStart(2,"0")}`};class L extends r.exports.Component{constructor(e){super();this.progressEl=r.exports.createRef(),this.props=e,this.state={width:0,hoverProgress:0,isHover:!1,canDrag:!1},this.handleHover=this.handleHover.bind(this),this.handleBlur=this.handleBlur.bind(this),this.handleTouchstart=this.handleTouchstart.bind(this),this.handleTouchend=this.handleTouchend.bind(this),this.handleStartDrag=this.handleStartDrag.bind(this),this.handleMove=this.handleMove.bind(this),this.handleMouseup=this.handleMouseup.bind(this),this.handleResize=this.handleResize.bind(this)}componentDidMount(){this.handleResize(),window.addEventListener("resize",this.handleResize)}componentWillUnmount(){window.removeEventListener("resize",this.handleResize)}handleHover(){this.setState({isHover:!0}),this.state.canDrag||(window.addEventListener("mousemove",this.handleMove),window.addEventListener("mouseup",this.handleMouseup))}handleBlur(){this.setState({isHover:!1}),this.state.canDrag||(window.removeEventListener("mousemove",this.handleMove),window.removeEventListener("mouseup",this.handleMouseup))}handleTouchstart(e){this.setState({canDrag:!0,isHover:!0},()=>{this.handleStartDrag(),this.handleMove(e)}),window.addEventListener("touchmove",this.handleMove),window.addEventListener("touchend",this.handleTouchend)}handleTouchend(e){e.preventDefault();const{ended:t,onPlay:a}=this.props;this.setState({isHover:!1,canDrag:!1}),this.beforeStatus&&(t||a(!1)),window.removeEventListener("touchmove",this.handleMove),window.removeEventListener("touchend",this.handleTouchend)}handleStartDrag(e){this.setState({canDrag:!0}),this.beforeStatus=this.props.status,this.props.onPause(!1),this.props.onSetProgress(this.state.hoverProgress)}handleMove(e){let t;~e.type.indexOf("touch")?[{clientX:t}]=e.touches:{clientX:t}=e;const{left:a}=this.progressEl.current.getBoundingClientRect(),{clientWidth:i}=this.progressEl.current,n=t-a,d=Math.max(Math.min(n,i),0)/i;this.setState({hoverProgress:d},()=>{this.state.canDrag&&this.props.onSetProgress(this.state.hoverProgress)})}handleMouseup(){const{ended:e,onPlay:t}=this.props;this.setState({canDrag:!1}),this.beforeStatus&&(e||t(!1)),this.state.isHover||(window.removeEventListener("mousemove",this.handleMove),window.removeEventListener("mouseup",this.handleMouseup))}handleResize(){this.progressEl.current&&this.setState({width:this.progressEl.current.clientWidth})}get currentProgress(){return this.props.currentTime/this.props.duration||0}get hoverTime(){return this.state.hoverProgress*this.props.duration}get transformHoverTime(){return N(this.hoverTime)}render(){return s("div",{ref:this.progressEl,className:"video-progress",style:{"--width":this.state.width,"--progress":this.currentProgress,"--hover-progress":this.state.hoverProgress,"--buffered-progress":this.props.buffered},onMouseEnter:this.handleHover,onTouchStart:this.handleTouchstart,onMouseDown:this.handleStartDrag,onMouseLeave:this.handleBlur,children:u("div",{className:"video-progress__bar",children:[s("div",{className:"video-progress__buffered"}),s("div",{className:"video-progress__hover"}),s("div",{className:"video-progress__current"}),s("div",{className:"video-progress__dot",children:s("span",{})}),s("div",{className:w("video-progress__thumbnail",{"-active":this.state.isHover||this.state.canDrag}),children:u("div",{className:"video-progress__thumbnail-main",children:[s(I,{videoEl:".video-media__main video",currentTime:Math.ceil(this.hoverTime)}),s("div",{className:"video-progress__time",children:this.transformHoverTime})]})})]})})}}L.propTypes={status:l.number,currentTime:l.number,duration:l.number,buffered:l.number,ended:l.bool,onSetProgress:l.func,onPlay:l.func,onPause:l.func};const A=({initVolume:o="0.5",onChangeVolume:e})=>{const[t,a]=r.exports.useState(o),[i,n]=r.exports.useState(t),[h,d]=r.exports.useState(!1);r.exports.useEffect(()=>{e(t)},[t]);const m=p=>{a(p.target.value),p.target.value==="0"&&d(!0)},v=()=>{h?a(i==="0"?1:i):(n(t),a("0")),d(!h)};return u("div",{className:"video-volume",style:{"--progress":`${t*100}%`},children:[s("button",{className:"video-media__controls-item",title:h?"\u89E3\u9664\u975C\u97F3":"\u975C\u97F3",onClick:v,children:s(g,{name:h?"mute":"volume"})}),s("input",{className:"video-volume__range",type:"range",min:"0",max:"1",step:"0.01",value:t,onChange:m})]})};A.propTypes={initVolume:l.string,onChangeVolume:l.func};const B=({initAuto:o=!0,onSwitchAuto:e})=>{const[t,a]=r.exports.useState(!0);r.exports.useEffect(()=>{e(t)},[t]);const i=()=>{a(!t)};return s("button",{title:t?"\u5DF2\u555F\u7528\u81EA\u52D5\u64AD\u653E\u529F\u80FD":"\u5DF2\u505C\u7528\u81EA\u52D5\u64AD\u653E\u529F\u80FD",className:w("video-media__controls-item video-auto-next",{"-active":t}),onClick:i,children:s("div",{className:"video-auto-next__main",children:s("div",{className:"video-auto-next__button",children:s(g,{name:t?"play":"pause"})})})})};B.propTypes={initAuto:l.bool,onSwitchAuto:l.func};const F=({nextSource:o,duration:e=3,onChangeIsPlayNext:t,onNext:a})=>{const i=r.exports.useRef(null),[n,h]=r.exports.useState(e),[d,m]=r.exports.useState(!1);r.exports.useEffect(()=>(v(),()=>{window.clearTimeout(i.current)}),[]);const v=(b=n)=>{window.clearTimeout(i.current),i.current=window.setTimeout(()=>{const S=b-1;if(h(S),b>1){v(S);return}y()},1e3)},p=()=>{window.clearTimeout(i.current),t(!1)},y=()=>{m(!0),a()};return s("div",{className:w("video-next",{"-active":!d}),children:u("div",{className:"video-next__main",children:[s("p",{className:"video-next__info",children:n>0?`\u4E0B\u4E00\u500B\u5F71\u7247\u5C07\u5728${n}\u79D2\u5F8C\u64AD\u653E`:"\u5373\u5C07\u958B\u59CB\u64AD\u653E"}),u("div",{className:"video-next__content",children:[s("div",{className:"video-next__image",style:{background:`#111 url(${o.thumbnail}) no-repeat center / cover`}}),s("p",{className:"video-next__title",children:o.name})]}),u("div",{className:"video-next__buttons",children:[s("button",{className:"video-next__button",onClick:p,children:"\u53D6\u6D88"}),s("button",{className:"video-next__button",onClick:y,children:"\u7ACB\u5373\u64AD\u653E"})]})]})})};F.propTypes={nextSource:l.object,duration:l.number,onChangeIsPlayNext:l.func,onNext:l.func};const H=({onBack:o,transformPlaybackRate:e,initPlaybackRate:t,onChangePlaybackRate:a})=>u("ul",{className:"video-playback-rate",children:[s("li",{className:"video-setting__item",onClick:()=>o(null),children:u("div",{className:"video-setting__item-option video-setting__item-display",children:[s("p",{children:"\u64AD\u653E\u901F\u5EA6"}),s("p",{children:e})]})}),[.25,.5,.75,1,1.25,1.5,1.75,2].map(n=>s("li",{className:"video-setting__item",onClick:()=>a(n),children:s("div",{className:"video-setting__item-option",children:n})},n)),s("li",{children:s("div",{className:"video-playback-rate__range video-setting__item-option",style:{"--progress":`${(t-.125)/2*100}%`},children:s("input",{type:"range",min:"0.25",max:"2",step:"0.01",value:t,onChange:n=>a(Number(n.target.value))})})})]});H.propTypes={onBack:l.func,transformPlaybackRate:l.string,initPlaybackRate:l.number,onChangePlaybackRate:l.func};const ne=(()=>{const e=function*(){let t=0;for(;;)yield t,t++}();return()=>e.next().value})(),oe=o=>{const e=ne();let t=o.dataset.blurs;if(t){t+=`, ${e}`;return}return o.setAttribute("data-blurs",e),e},ae=(o,e,t)=>{var n;const i=~(t.path||((n=t.composedPath)==null?void 0:n.call(t))).indexOf(o);i||e(i)},P={};var re=(o,e)=>{if(o instanceof Element&&typeof e=="function"){const t=ae.bind(void 0,o,e);return document.body.addEventListener("click",t),P[oe(o)]=t,()=>{o.dataset.blurs.split(", ").forEach(i=>{const n=P[i];document.body.removeEventListener("click",n),delete P[i]})}}};const le={playbackRate:H},O=({transformPlaybackRate:o,initPlaybackRate:e,onChangePlaybackRate:t,onChangeSettingStatus:a})=>{const i=r.exports.useRef(null),n=r.exports.useRef(null),h=r.exports.useRef(null),[d,m]=r.exports.useState(!1),[v,p]=r.exports.useState(null),[y,b]=r.exports.useState(0),[S,T]=r.exports.useState(0),c=le[v];return r.exports.useEffect(()=>{const f=re(i.current,()=>{m(!1),p(null)});return()=>{f()}},[]),r.exports.useEffect(()=>{if(v){T(h.current.clientHeight);return}T(n.current.clientHeight)},[v]),r.exports.useEffect(()=>{b(n.current.clientHeight)},[]),r.exports.useEffect(()=>{a(d)},[d]),u("div",{className:"video-setting",ref:i,children:[s("button",{title:"\u8A2D\u5B9A",className:"video-media__controls-item video-setting__display",onClick:()=>m(!d),children:s(g,{name:"setting"})}),s("div",{className:w("video-setting__main",{"-open":d,"-active":v}),style:{"--height":y,"--max-height":S},children:u("div",{children:[s("div",{className:"video-setting__content",ref:n,children:s("ul",{children:s("li",{className:"video-setting__item",onClick:()=>p("playbackRate"),children:u("div",{className:"video-setting__item-option video-setting__item-display",children:[s("p",{children:"\u64AD\u653E\u901F\u5EA6"}),s("p",{children:o})]})})})}),s("div",{className:"video-setting__content",ref:h,children:v?s(c,{onBack:f=>p(f),transformPlaybackRate:o,initPlaybackRate:e,onChangePlaybackRate:t}):null})]})})]})};O.propTypes={transformPlaybackRate:l.string,initPlaybackRate:l.number,onChangePlaybackRate:l.func,onChangeSettingStatus:l.func};class Z extends r.exports.Component{constructor(e){super();this.videoEl=r.exports.createRef(),this.props=e,this.state={isFirstEnter:!1,showIconsTip:!1,showSetting:!1,showControl:!1,autoNext:!0,isPlayNext:!0,perTimeSeek:5,tipStatus:null,videoStatus:0,videoCurrentTime:0,videoDuration:0,videoBuffered:0,videoVolume:window.sessionStorage.getItem("volume")||"1",videoPlaybackRate:Number(window.sessionStorage.getItem("playbackRate"))||1,videoEnded:!1},this.controlTimer=null,this.tipTimer=null,this.tipDuration=1,this.tapTimer=null,this.isTapOnce=!1,this.handleOnload=this.handleOnload.bind(this),this.handlePlay=this.handlePlay.bind(this),this.handlePause=this.handlePause.bind(this),this.handleToggleStatus=this.handleToggleStatus.bind(this),this.handleVideoStatus=this.handleVideoStatus.bind(this),this.handleChangeVolume=this.handleChangeVolume.bind(this),this.handleVolumeStatus=this.handleVolumeStatus.bind(this),this.handleChangePlaybackRate=this.handleChangePlaybackRate.bind(this),this.handlePlaybackRateStatus=this.handlePlaybackRateStatus.bind(this),this.handleToggleFullscreen=this.handleToggleFullscreen.bind(this),this.handleTogglePictureInPicture=this.handleTogglePictureInPicture.bind(this),this.handleOnTracked=this.handleOnTracked.bind(this),this.handleOnProgress=this.handleOnProgress.bind(this),this.handleSetProgress=this.handleSetProgress.bind(this),this.handleChangeSettingStatus=this.handleChangeSettingStatus.bind(this),this.switchIconsTip=this.switchIconsTip.bind(this),this.handleKeydown=this.handleKeydown.bind(this),this.handleTouchstart=this.handleTouchstart.bind(this),this.handleDoubleTap=this.handleDoubleTap.bind(this),this.handleOnSwitchAuto=this.handleOnSwitchAuto.bind(this),this.handleChangeIsPlayNext=this.handleChangeIsPlayNext.bind(this)}componentDidMount(){window.addEventListener("keydown",this.handleKeydown)}componentDidUpdate(e,t){const{source:a}=this.props;e.source!==a&&(window.sessionStorage.setItem("currentTime",0),this.videoEl.current.load())}componentWillUnmount(){window.removeEventListener("keydown",this.handleKeydown)}handleOnload(){const{duration:e}=this.videoEl.current;this.setState({videoStatus:0,videoDuration:e}),this.loadedPreset()}handleChangeCurrentTime(e){this.videoEl.current.currentTime=e}handlePlay(e=!0){const{videoEnded:t}=this.state;t&&this.handleChangeCurrentTime(0),this.videoEl.current.play(),this.switchIconsTip(e)}handlePause(e=!0){this.videoEl.current.pause(),this.switchIconsTip(e)}handleToggleStatus(e=!0){const{videoStatus:t}=this.state;if(!t){this.handlePlay(e);return}this.handlePause(e)}handleVideoStatus(){const{paused:e}=this.videoEl.current;this.setState({videoStatus:!e|0})}handleChangeVolume(e){this.videoEl.current.volume=e}handleVolumeStatus(){const{volume:e}=this.videoEl.current;this.setState({videoVolume:String(e)}),window.sessionStorage.setItem("volume",e)}handleChangePlaybackRate(e){this.videoEl.current.playbackRate=e,window.sessionStorage.setItem("playbackRate",e)}handlePlaybackRateStatus(){const{playbackRate:e}=this.videoEl.current;this.setState({videoPlaybackRate:e})}handleToggleFullscreen(){var e,t,a,i,n,h,d,m;if(document.fullscreen){((e=document.exitFullscreen)==null?void 0:e.call(document))||((t=document.webkitCancelFullScreen)==null||t.call(document));return}((i=(a=this.videoEl.current.parentNode.parentNode).requestFullscreen)==null?void 0:i.call(a))||((h=(n=this.videoEl.current.parentNode.parentNode).webkitRequestFullScreen)==null?void 0:h.call(n))||((m=(d=this.videoEl.current).webkitEnterFullscreen)==null||m.call(d))}handleTogglePictureInPicture(){document.pictureInPictureElement?document.exitPictureInPicture():document.pictureInPictureEnabled&&this.videoEl.current.requestPictureInPicture()}handleOnTracked(){const{currentTime:e,duration:t}=this.videoEl.current;this.setState({videoCurrentTime:e,videoEnded:e===t}),window.sessionStorage.setItem("currentTime",e)}handleOnProgress(){const{videoCurrentTime:e,videoDuration:t}=this.state,{buffered:a}=this.videoEl.current;let i=0;for(let n=0;n<a.length;n++)if(a.start(a.length-1-n)<e){i=a.end(a.length-1-n)/t;break}this.setState({videoBuffered:i})}handleSetProgress(e){const{videoDuration:t}=this.state;this.handleChangeCurrentTime(t*e),this.changeControlStatus(!0,!0)}handleChangeSettingStatus(e){if(this.changeControlStatus(e),e!==void 0){this.setState({showSetting:e});return}this.setState({showSetting:!this.state.showSetting})}handleKeydown(e){const{code:t}=e;t==="Space"&&(e.preventDefault(),this.handleToggleStatus()),t==="ArrowRight"&&(e.preventDefault(),this.fastForward()),t==="ArrowLeft"&&(e.preventDefault(),this.fastBackward()),this.changeControlStatus(!0,!0),this.switchIconsTip()}handleTouchstart(e){this.changeControlStatus(!0,!0),this.isShowControl&&this.handleToggleStatus()}handleDoubleTap(e){if(!this.isTapOnce){this.isTapOnce=!0,this.tapTimer=window.setTimeout(()=>{this.handleTouchstart()},300),window.setTimeout(()=>{this.isTapOnce=!1},300);return}window.clearTimeout(this.tapTimer),e==="left"&&this.fastBackward(),e==="right"&&this.fastForward(),this.changeControlStatus(!0,!0),this.switchIconsTip()}handleOnSwitchAuto(e){this.setState({autoNext:e})}handleChangeIsPlayNext(e){this.setState({isPlayNext:e})}fastForward(){const{perTimeSeek:e,videoCurrentTime:t,videoDuration:a}=this.state,i=Math.min(t+e,a);this.handleChangeCurrentTime(i),this.setState({tipStatus:null}),setTimeout(()=>{this.setState({tipStatus:"forward"})},50)}fastBackward(){const{perTimeSeek:e,videoCurrentTime:t}=this.state;this.handleChangeCurrentTime(t-e),this.setState({tipStatus:null}),setTimeout(()=>{this.setState({tipStatus:"backward"})},50)}changeControlStatus(e,t=!1){e=e===void 0?!this.state.showControl:e,window.clearTimeout(this.controlTimer),this.controlTimer=window.setTimeout(()=>{this.setState({showControl:e}),e&&t&&this.changeControlStatus(!1)},e?0:3e3)}switchIconsTip(e=!0){window.clearTimeout(this.tipTimer),this.setState({showIconsTip:e}),e&&(this.tipTimer=window.setTimeout(()=>{this.setState({showIconsTip:!1})},this.tipDuration*1e3))}loadedPreset(){this.loadSessionStorage(),this.handleChangeIsPlayNext(!0),this.state.isFirstEnter&&this.handlePlay(!1),this.setState({isFirstEnter:!0})}loadSessionStorage(){window.sessionStorage.getItem("currentTime")>0&&this.handleChangeCurrentTime(window.sessionStorage.getItem("currentTime")),this.handleChangeVolume(window.sessionStorage.getItem("volume")||"1"),this.handleChangePlaybackRate(Number(window.sessionStorage.getItem("playbackRate"))||1)}get isShowControl(){const{videoStatus:e,showControl:t}=this.state;return!e||t}get isInfoNext(){const{videoEnded:e,autoNext:t,isPlayNext:a}=this.state;return e&&t&&a}get transformTime(){const{videoCurrentTime:e}=this.state;return N(e)}get transformTotalTime(){const{videoDuration:e}=this.state;return N(e)}get transformPlaybackRate(){return new Map([[.25,"0.25"],[.5,"0.5"],[.75,"0.75"],[1,"\u6B63\u5E38"],[1.25,"1.25"],[1.5,"1.5"],[1.75,"1.75"],[2,"2"]]).get(this.state.videoPlaybackRate)||String(this.state.videoPlaybackRate)}render(){return u("div",{className:"video-media",children:[s("div",{className:"video-media__main",children:s("video",{playsInline:!0,poster:this.props.source.thumbnail,ref:this.videoEl,onLoadedMetadata:this.handleOnload,onPlay:this.handleVideoStatus,onPause:this.handleVideoStatus,onVolumeChange:this.handleVolumeStatus,onRateChange:this.handlePlaybackRateStatus,onTimeUpdate:this.handleOnTracked,onSeeking:this.handleOnTracked,onProgress:this.handleOnProgress,children:s("source",{src:this.props.source.source,type:"video/mp4"})})}),u("div",{className:w("video-media__controls",{"-active":this.isShowControl}),children:[u("div",{className:w("video-media__controls-mask",{"-active":this.state.showIconsTip,"-play":this.state.videoStatus,"-pause":!this.state.videoStatus,"-forward":this.state.tipStatus==="forward","-backward":this.state.tipStatus==="backward"}),style:{"--tip-duration":this.tipDuration},onClick:this.handleToggleStatus,onDoubleClick:this.handleToggleFullscreen,children:[s("div",{className:"video-media__controls-mask-icon -play",children:s("span",{children:s(g,{name:"play"})})}),s("div",{className:"video-media__controls-mask-icon -pause",children:s("span",{children:s(g,{name:"pause"})})}),s("div",{className:"video-media__controls-mask-icon -forward",children:u("span",{children:[this.state.perTimeSeek,"\u79D2"]})}),s("div",{className:"video-media__controls-mask-icon -backward",children:u("span",{children:[this.state.perTimeSeek,"\u79D2"]})}),s("div",{className:"video-media__controls-tap-area -left",onTouchStart:()=>this.handleDoubleTap("left"),onTouchEnd:e=>e.preventDefault()}),s("div",{className:"video-media__controls-tap-area -right",onTouchStart:()=>this.handleDoubleTap("right"),onTouchEnd:e=>e.preventDefault()})]}),s("div",{className:w("video-media__controls-info",{"-active":this.isInfoNext}),children:this.isInfoNext?s(F,{nextSource:this.props.nextSource,onChangeIsPlayNext:this.handleChangeIsPlayNext,onNext:this.props.onChangeNextVideo}):null}),u("div",{className:w("video-media__controls-main",{"-setting":this.state.showSetting}),children:[s(L,{status:this.state.videoStatus,currentTime:this.state.videoCurrentTime,duration:this.state.videoDuration,buffered:this.state.videoBuffered,ended:this.state.videoEnded,onPause:this.handlePause,onPlay:this.handlePlay,onSetProgress:this.handleSetProgress},this.props.source.name),s("span",{className:"video-media__setting-mask"}),u("div",{className:"video-media__controls-list",children:[u("div",{className:"video-media__controls-items",children:[s("button",{title:this.state.videoEnded?"\u91CD\u64AD":this.state.videoStatus?"\u66AB\u505C":"\u64AD\u653E",className:"video-media__controls-item video-media__controls-status",onClick:this.handleToggleStatus,children:s(g,{name:this.state.videoEnded?"replay":this.state.videoStatus?"pause":"play"})}),s("button",{title:"\u4E0B\u4E00\u500B",className:"video-media__controls-item",onClick:this.props.onChangeNextVideo,children:s(g,{name:"skip"})}),u("div",{className:"video-media__time",children:[this.transformTime," / ",this.transformTotalTime]}),s(A,{initVolume:this.state.videoVolume,onChangeVolume:this.handleChangeVolume})]}),u("div",{className:"video-media__controls-items",children:[s(B,{initAuto:this.state.autoNext,onSwitchAuto:this.handleOnSwitchAuto}),s(O,{transformPlaybackRate:this.transformPlaybackRate,initPlaybackRate:this.state.videoPlaybackRate,onChangePlaybackRate:this.handleChangePlaybackRate,onChangeSettingStatus:this.handleChangeSettingStatus}),s("button",{title:"\u8FF7\u4F60\u64AD\u653E\u5668",className:"video-media__controls-item video-media__controls-picture-in-picture",onClick:this.handleTogglePictureInPicture,children:s(g,{name:"picture"})}),s("button",{title:"\u5168\u87A2\u5E55",className:"video-media__controls-item video-media__controls-fullscreen",onClick:this.handleToggleFullscreen,children:s(g,{name:"fullscreen"})})]})]})]})]})]})}}Z.propTypes={source:l.object,nextSource:l.object,onChangeNextVideo:l.func};function de(){const{search:o}=G(),e=J(),[t,a]=r.exports.useState([{name:"\u3010\u6708\u7403\u9695\u843D\u3011HD\u4E2D\u6587\u6B63\u5F0F\u96FB\u5F71\u9810\u544A",source:new URL("./assets/video1.942c93a0.mp4",self.location).href,thumbnail:new URL("./assets/img1.af7e08f1.jpg",self.location).href},{name:"\u3010\u6885\u8277\u82B3Anita\u3011\u6B63\u5F0F\u9810\u544A",source:new URL("./assets/video2.fe941c35.mp4",self.location).href,thumbnail:new URL("./assets/img2.358087ff.jpg",self.location).href},{name:"\u3010\u8718\u86DB\u4EBA\uFF1A\u7121\u5BB6\u65E5\u3011\u6700\u65B04K\u524D\u5C0E\u96FB\u5F71\u9810\u544A",source:new URL("./assets/video3.1f10e585.mp4",self.location).href,thumbnail:new URL("./assets/img3.ea0b1b36.jpg",self.location).href}]),i=r.exports.useMemo(()=>new URLSearchParams(o,[o])),n=r.exports.useMemo(()=>{const v=t.findIndex(({name:p})=>p===i.get("watch"));return~v?v:0}),h=r.exports.useMemo(()=>t[n],[t,n]),d=r.exports.useMemo(()=>t[(n+1)%t.length],[t,n]);return s("div",{className:"page-index",children:s("div",{className:"container",children:s(Z,{source:h,nextSource:d,onChangeNextVideo:()=>{e.push({search:`?watch=${d.name}`})}})})})}function he(){return s("div",{className:"page-about",children:"About"})}Y.render(s(ee.StrictMode,{children:s(te,{children:u(se,{children:[s(V,{path:"/about",children:s(he,{})}),s(V,{path:"/",children:s(de,{})})]})})}),document.getElementById("root"));
